---
title: Linux的正则表达式
date: 2018-02-03 09:17:37
modified:
categories:
- Linux
tags:
- Linux
- Shell
---

### 通配符
|元字符|作用|
|:---:|:---|
|*|匹配0个或任意多个字符，也就是可以匹配任何内容|
|?|匹配任意一个字符|
|[]|匹配[ ]中任意一个字符|
|[-]|匹配括号中任意一个字符，-代表一个范围，例如：[a-z]代表匹配一个小写字母|
|[^]|逻辑非，表示匹配不是中括号内的一个字符，例如[^0-9]代表匹配一个不是数字的字符|


### 正则表达式
#### 基础正则表达式
|元字符|作用|
|:---:|:---|
|*|前一个字符匹配0次或任意多次，匹配0次前一个字符则表示匹配任意字符，包括空白行|
|.|匹配除了换行符以外任意一个字符，“.*”匹配所有内容|
|^|用于指定匹配字符串的头部，也称行首定位符；匹配行首。例如：^hello会匹配以hello开头的行，grep -n “^$” test.txt匹配空白行并显示行号|
|$|用于指定匹配字符串的尾部，也称行尾定位符；匹配行尾。例如：hello$会匹配以hello结尾的行|
|[]|匹配中括号中指定的任意一个字符，只匹配一个字符，要匹配[则要转义\[|
|[^]|匹配除中括号的字符以外的任意一个字符|
|\|转义符用于取消特殊符号的含义，匹配包含以.结尾的行grep “\.$” test.txt|
|\{n\}|表示其前面的字符恰好出现n次。例如：[0-9]\{4\}匹配4位数字，但注意添加两边的定界符，以精确匹配|
|\{n,\}|表示其前面的字符出现不小于n次。例如：[0-9]\{2,\}匹配2位以上的数字|
|\{n,m\}|表示其前面的字符至少出现n次，最多出现m次。例如：[a-z]\{6,8}匹配6到8位的小写字母|

> 注1：`?、()`是扩展正则中的元字符 
  注2：正则表达式中使用以上的元字符，如`[]、{}、*、. `等所以在匹配字符串中包含有这些元字符时必须使用反斜杠`\\`转义，但像`<>`这个非元字符符号就不需要转义。

#### 特殊字符

正则表达式识别的特殊字符包括：
> .*[]^$&#123;&#125;\\+?()

如果需要将特殊字符当作普通字符来使用，必须对特殊字符进行转义。

#### 特殊字符组

|组|描述|
|:---:|:---:|
|[[:alpha:]]|匹配任意的字母字符，不管是大写还是小写|
|[[:alnum:]]|匹配任意的字母数字字符0~9，A~Z或a~z|
|[[:blank:]]|匹配空格或制表符|
|[[:digit:]]|匹配0~9之间的数字|
|[[:lower:]]|匹配小写字母字符a~z|
|[[:print:]]|匹配任意可打印字符|
|[[:punct:]]|匹配标点符号|
|[[:space:]]|匹配任意空白字符：空格、制表符、NF、FF、VT和CR|
|[[:upper:]]|匹配任意大写字母字符A~Z|

#### 扩展正则表达式

> 需要注意的是，gawk程序可以识别扩展正则表达式，而sed编辑器不能。

|元字符|作用| 
|:---:|:---|
|&#124;|管道符，表示或，即匹配其中任何一个，book&#124;desk将匹配book或desk|
|()|小括号，可以将正则字符和元字符或表达式进行组合，(book&#124;desk)s将匹配books或desks|
|?|问号，匹配0个或1个前导表达式，如`a?`匹配其他字符串或a|
|\<|反斜杠+小于号，词首定位符， `\< abc`表示所有包含以`abc`开头的单词的行|
|\\>|反斜杠+大于号，词尾定位符， `\>abc`表示所有包含以`abc`结尾的单词的行|
|-|减号，用于指明字符范围， `[a-c]`将匹配包含`a、b和c`中任意一个字符的字符串|
|+|加号，匹配一个或多个前导表达式，相当于`expr{1,}`|
|&#123;&#125;|为重复的正则表达式设定一个范围|

### 练习

#### 目录文件计数

```
#!/bin/bash

mypath=$(echo $PATH | sed 's/:/ /g')
count=0

for dir in $mypath
do
  subdir=$(ls $dir)
  for item in $subdir
  do
    count=$[ $count + 1]
  done
  echo "$dir ---- $count" 
  count=0
done
```

#### 解析邮件地址

```
^([a-zA-Z0-9_\-\.\+]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]{2,5})$
```
