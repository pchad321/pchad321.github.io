---
title: 爬虫之动态html的处理 
date: 2018-07-02 14:44:15
modified:
categories:
- Spider
tags:
- Spider 
- dynamic html
---

### 关于爬虫部分一些建议：

1. 尽量减少请求次数，能抓列表页就不抓详情页，减轻服务器压力，程序员都是混口饭吃不容易。  
2. 不要只看Web网站，还有手机App和H5，这样的反爬虫措施一般比较少。  
3. 实际应用时候，一般防守方做到根据IP限制频次就结束了，除非很核心的数据，不会再进行更多的验证，毕竟成本的问题会考虑到。  
4. 如果真的对性能要求很高，可以考虑多线程(一些成熟的框架如 Scrapy都已支持)，甚至分布式...

### DHTML

与Ajax一样，动态HTML(Dynamic HTML, DHTML)也是一系列用于解决网络问题的技术集合。DHTML是用客户端语言改变页面的HTML元素(HTML、CSS，或者二者皆被改变)。比如页面上的按钮只有当用户移动鼠标之后才出现,背景色可能每次点击都会改变，或者用一个Ajax请求触发页面加载一段新内容，网页是否属于DHTML，关键要看有没有用JavaScript控制HTML和CSS元素。  

那些使用了Ajax或DHTML技术改变/加载内容的页面，可能有一些采集手段。但是用Python解决这个问题只有两种途径:
- 直接从JavaScript代码里采集内容（费时费力）
- 用Python的第三方库运行JavaScript，直接采集你在浏览器里看到的页面（这个可以有）。

### Selenium和phantomjs

#### Selenium

Selenium是一个Web的自动化测试工具，最初是为网站自动化测试而开发的，类型像我们玩游戏用的按键精灵，可以按指定的命令自动操作，不同是Selenium可以直接运行在浏览器上，它支持所有主流的浏览器（包括PhantomJS这些无界面的浏览器）。  
Selenium可以根据我们的指令，让浏览器自动加载页面，获取需要的数据，甚至页面截屏，或者判断网站上某些动作是否发生。  
Selenium自己不带浏览器，不支持浏览器的功能，它需要与第三方浏览器结合在一起才能使用。但是我们有时候需要让它内嵌在代码中运行，所以我们可以用一个叫PhantomJS的工具代替真实的浏览器。

#### PhantomJS

PhantomJS是一个基于Webkit的“无界面”(headless)浏览器，它会把网站加载到内存并执行页面上的JavaScript，因为不会展示图形界面，所以运行起来比完整的浏览器要高效。  
如果把Selenium和PhantomJS结合在一起，就可以运行一个非常强大的网络爬虫了，这个爬虫可以处理JavaScrip、Cookie、headers，以及任何我们真实用户需要做的事情。  
